Index: toolkit/components/nsDefaultCLH.js
===================================================================
RCS file: /cvsroot/mozilla/toolkit/components/nsDefaultCLH.js,v
retrieving revision 1.5.8.1
diff -u -8 -p -r1.5.8.1 nsDefaultCLH.js
--- toolkit/components/nsDefaultCLH.js	20 Jul 2006 01:19:28 -0000	1.5.8.1
+++ toolkit/components/nsDefaultCLH.js	1 Sep 2006 19:58:21 -0000
@@ -15,16 +15,17 @@
  *
  * The Initial Developer of the Original Code is
  * Benjamin Smedberg <benjamin@smedbergs.us>
  *
  * Portions created by the Initial Developer are Copyright (C) 2004
  * the Initial Developer. All Rights Reserved.
  *
  * Contributor(s):
+ *  Daniel Glazman <daniel.glazman@disruptive-innovations.com>
  *
  * Alternatively, the contents of this file may be used under the terms of
  * either the GNU General Public License Version 2 or later (the "GPL"), or
  * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
  * in which case the provisions of the GPL or the LGPL are applicable instead
  * of those above. If you wish to allow use of your version of this file only
  * under the terms of either the GPL or the LGPL, and not to allow others to
  * use your version of this file under the terms of the MPL, indicate your
@@ -46,19 +47,21 @@ const nsIModule                = Compone
 const nsIPrefBranch            = Components.interfaces.nsIPrefBranch;
 const nsISupportsString        = Components.interfaces.nsISupportsString;
 const nsIWindowWatcher         = Components.interfaces.nsIWindowWatcher;
 
 /**
  * This file provides a generic default command-line handler.
  *
  * It opens the chrome window specified by the pref "toolkit.defaultChromeURI"
- * the arguments passed to the window are the nsICommandLine instance.
+ * with the flags specified by the pref "toolkit.defaultChromeFlags"
+ * or "chrome,dialog=no,all" is it is not available.
+ * The arguments passed to the window are the nsICommandLine instance.
  *
- * It doesn't do anything if the pref is unset.
+ * It doesn't do anything if the pref "toolkit.defaultChromeURI" is unset.
  */
 
 var nsDefaultCLH = {
   /* nsISupports */
 
   QueryInterface : function clh_QI(iid) {
     if (iid.equals(nsICommandLineHandler) ||
         iid.equals(nsIFactory) ||
@@ -89,20 +92,26 @@ var nsDefaultCLH = {
       }
     }
     catch (e) { }
 
     // if the pref is missing, ignore the exception 
     try {
       var chromeURI = prefs.getCharPref("toolkit.defaultChromeURI");
 
+      var flags = "chrome,dialog=no,all";
+      try {
+        flags = prefs.getCharPref("toolkit.defaultChromeFeatures");
+      }
+      catch (e) { }
+
       var wwatch = Components.classes["@mozilla.org/embedcomp/window-watcher;1"]
                             .getService(nsIWindowWatcher);
       wwatch.openWindow(null, chromeURI, "_blank",
-                        "chrome,dialog=no,all", cmdLine);
+                        flags, cmdLine);
     }
     catch (e) { }
   },
 
   helpInfo : "",
 
   /* nsIFactory */
 
