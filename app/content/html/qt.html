<html>
<body onload="bindPlayer();">
<script language="JavaScript">

var theQTCore = null;

var isBuffering = false;
var isPlaying = false;
var isPaused = false;
var isMuted = false;
var lastVolume = 0;

var waitForPlayInterval = null;

function bindPlayer()
{
  initPlayer();
}

function initPlayer()
{
  if(!theQTCore) {
    var theCore = document.getElementById("core_qt");
    theQTCore = theCore;
  }
}

function waitForPlayer()
{
  initPlayer();
  
  var playerStatus = theQTCore.GetPluginStatus();
  
  switch(playerStatus)
  {
    case "Waiting":
    break;
    
    case "Loading":
    break;
    
    case "Playable":
    case "Complete":
      isBuffering = false;
      clearInterval(waitForPlayInterval);
      waitForPlayInterval = 0;
      playPlayer();
    break;
    
    default:
      if(playerStatus == null || playerStatus.indexOf("Error") != -1)
      {
        //Probably an error :(
        isBuffering = false;
        isPlaying = false;
        isPaused = false;
        clearInterval(waitForPlayInterval);
        waitForPlayInterval = 0;
      }
  }
}

function playURL(url)
{
  initPlayer();

  isBuffering = true;  
  theQTCore.SetURL(url);
  
  setPlayerVolume(lastVolume);
  waitForPlayInterval = setInterval("waitForPlayer();", 50);
}

function playPlayer()
{
  initPlayer();
  
  if(!isPlaying || isPaused)
  { 
    theQTCore.Play();
    isPlaying = true;
    isPaused = false;
  }
}

function pausePlayer()
{
  initPlayer();

  if(!isPaused)
  {
    theQTCore.Stop();
    isPaused = true;
  }
  else
  {
    theQTCore.Play();
    isPaused = false;
  }
}

function stopPlayer()
{
  initPlayer();
  
  isPlaying = false;
  isPaused = false;
  
  theQTCore.Stop();
  theQTCore.Rewind();
}

function getPlayerVolume()
{
  initPlayer();
  return theQTCore.GetVolume();
}

function setPlayerVolume(vol)
{
  initPlayer();
  lastVolume = vol;
  theQTCore.SetVolume(vol);
}

function mutePlayer( mute )
{
  initPlayer();
  theQTCore.SetMute(mute);
  isMuted = mute;
}

function getPlayerLength()
{
  initPlayer();
  
  //If we're buffering, we don't have the length, but we don't want
  //playlist playback to go to the next track while we're buffering so
  //we fake a 1ms length when buffering.

  if(isBuffering) return 1;
  
  return theQTCore.GetDuration();
}

function getPlayerPosition()
{
  initPlayer();
  return theQTCore.GetTime();
}

function seekPlayer(pos)
{
  initPlayer();
  theQTCore.SetTime(pos);
}
</script>
<embed id="core_qt" name="core_qt" EnableJavaScript="true" AllowEmbedTagOverrides="true" SaveEmbedTags="true" autoplay="false" controller="false" target="myself" type="application/x-rtsp">
</embed>
</body>
</html>
