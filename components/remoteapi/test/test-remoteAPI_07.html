<!--
/*
 //
// BEGIN NIGHTINGALE GPL
//
// This file is part of the Nightingale web player.
//
// Copyright(c) 2005-2008 POTI, Inc.
// http://getnightingale.com
//
// This file may be licensed under the terms of of the
// GNU General Public License Version 2 (the "GPL").
//
// Software distributed under the License is distributed
// on an "AS IS" basis, WITHOUT WARRANTY OF ANY KIND, either
// express or implied. See the GPL for the specific language
// governing rights and limitations.
//
// You should have received a copy of the GPL along with this
// program. If not, go to http://www.gnu.org/licenses/gpl.html
// or write to the Free Software Foundation, Inc.,
// 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
//
// END NIGHTINGALE GPL
//
 */
-->

<html>
  <head>
    <title>Remote API Test: 07</title>
    <script>
      var originalCommand = true;
      var toggleCommand = function() {
        if (originalCommand) {
          nightingale.commands.addCommand( "action",
                                        "toggled-command",
                                        "toggle",
                                        "toggle" );
        } else {
          nightingale.commands.removeCommand("toggled-command");
        }
        originalCommand = !originalCommand;
      }

      var addCommand = function() {
          nightingale.commands.addCommand( "action",
                                        "add-command",
                                        "Added",
                                        "Add Command" );
      }

      var removeCommand = function() {
          nightingale.commands.removeCommand("add-command");
      }

      var onPlay = function onPlay(event) {
        if (event.type == "play") {
          nightingale.play();
        } else if (event.type == "play-list") {
          nightingale.playMediaList(nightingale.webPlaylist.mediaList, 0);
        } else if (event.type == "play-url") {
          nightingale.playURL('http://sandbox.getnightingale.com/~redfive/test_files/ccmixter/FFGreen_-_PLoo_Part_4.mp3');
        }
      }

      var accessCount = 0;
      var onRemoteAPI =  function onRemoteAPI(aEvent) {
        var myDiv = document.getElementById("accessCountDiv");
        if (aEvent.type == "remoteapi") {
          //myDiv.appendChild(document.createTextNode("Remote API Accessed:" + (++accessCount)));
          //myDiv.appendChild(document.createElement("br"));
        }
      };

      function dumpState () {
        var outDiv = document.getElementById("outputDiv");
        var myDiv = document.createElement("div");

        myDiv.appendChild(document.createTextNode("Num: " + nightingale.commands.getNumCommands(null, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "Type: " + nightingale.commands.getCommandType(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "ID: " + nightingale.commands.getCommandId(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "Text: " + nightingale.commands.getCommandText(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "TtText: " + nightingale.commands.getCommandToolTipText(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "Enabled: " + nightingale.commands.getCommandEnabled(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "Flag: " + nightingale.commands.getCommandFlag(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "Visible: " + nightingale.commands.getCommandVisible(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "Value: " + nightingale.commands.getCommandValue(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "ShortcutMod: " + nightingale.commands.getCommandShortcutModifiers(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "ShortcutKey: " + nightingale.commands.getCommandShortcutKey(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "ShortcutKeycode: " + nightingale.commands.getCommandShortcutKeycode(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        myDiv.appendChild(document.createTextNode( "ShortcutLocal: " + nightingale.commands.getCommandShortcutLocal(null, 0, null)));
        myDiv.appendChild(document.createElement("br"));
        outDiv.appendChild(myDiv);
      }

    </script>
  </head>
  <body onunload="document.removeEventListener('remoteapi', onRemoteAPI, true);">
    <h1>RemoteCommand registration, object access, callbacks</h1>
    <p> create a remoteCommand, get callbacks for it's events and see
        callbacks happen. </p>
    <br />
    <p> Force a web playlist to appear. <br />
      <a href="http://sandbox.getnightingale.com/~redfive/test_files/ccmixter/Loveshadow_-_The_Acorns._Seedin_Time_in_The_Oak_Room..mp3">Loveshadow</a>
      <a href="http://sandbox.getnightingale.com/~redfive/test_files/ccmixter/Sawtooth_-_We_Are_Not_Evil_(Down_To_Brass_Tacks_Remix).mp3">Sawtooth</a>
    </p>
    <form>
      <input type="button" id="toggle_button" value="Toggle"
             onclick="toggleCommand();" /> 
      <br />
      <input type="button" id="toggle_button" value="Add Command"
             onclick="addCommand();" /> 
      <br />
      <input type="button" id="toggle_button" value="Remove Command"
             onclick="removeCommand();" /> 
      <br />
      <input type="button" id="dump_button" value="Dump State"
             onclick="dumpState();" /> 
    </form>
    <div id="accessCountDiv">
    </div>
    <div id="outputDiv">
    </div>
    <script>

      // hook listeners to command from this page and the general RemoteAPI event
      document.addEventListener( "remoteapi", onRemoteAPI, true );
      document.addEventListener( "play-url", onPlay, true );
      document.addEventListener( "play", onPlay, true );
      document.addEventListener( "play-list", onPlay, true );

      // add a command to the RemoteAPI's collection of commands
/*
      // XXXredfive the submenu implementation for remote commands is broken 
      nightingale.commands.addCommand( "submenu",
                                    "rapi-test-07-submenu",
                                    "Play URL",
                                    "Play the preset URL" );
      nightingale.commands.removeCommand("rapi-test-07-submenu");
*/


      nightingale.commands.setCommandData( 3,
                                        ["action","separator", "action"],
                                        ["play-url","play-sep","play"],
                                        ["Play URL","sep","Play"],
                                        ["Play the preset URL","separate","Play"] );
      nightingale.commands.addCommand( "action",
                                    "play-list",
                                    "Play list",
                                    "Play a list" );

    </script>
    
  </body>
</html>

